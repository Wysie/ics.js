/*! ics.js Mon May 04 2015 19:26:48 */
var ics=function(){"use strict";if(navigator.userAgent.indexOf("MSIE")>-1&&-1==navigator.userAgent.indexOf("MSIE 10"))return void console.log("Unsupported Browser");var a=-1!==navigator.appVersion.indexOf("Win")?"\r\n":"\n",b=[],c=["BEGIN:VCALENDAR","VERSION:2.0"].join(a),d=a+"END:VCALENDAR";return{events:function(){return b},calendar:function(){return c+a+b.join(a)+d},addEvent:function(c,d,e,f,g,h,i){if("undefined"==typeof c||"undefined"==typeof d||"undefined"==typeof e||"undefined"==typeof f||"undefined"==typeof g)return!1;if("undefined"==typeof h&&(h=!1),i&&!i.rule){if("YEARLY"!==i.freq&&"MONTHLY"!==i.freq&&"WEEKLY"!==i.freq&&"DAILY"!==i.freq)throw"Recurrence rule frequency must be provided and be one of the following: 'YEARLY', 'MONTHLY', 'WEEKLY', or 'DAILY'";if(i.until&&isNaN(Date.parse(i.until)))throw"Recurrence rule 'until' must be a valid date string";if(i.interval&&isNaN(parseInt(i.interval)))throw"Recurrence rule 'interval' must be an integer";if(i.count&&isNaN(parseInt(i.count)))throw"Recurrence rule 'count' must be an integer"}var j=moment(f),k=moment(g),l="",m="";h&&k.add(1,"days"),h?(l=j.utc().format("YYYYMMDD"),m=k.utc().format("YYYYMMDD")):(l=j.utc().format("YYYYMMDDhhmmss")+"Z",m=k.utc().format("YYYYMMDDhhmmss")+"Z");var n;if(i)if(i.rule)n=i.rule;else{if(n="RRULE:FREQ="+i.freq,i.until){var o=new Date(Date.parse(i.until)).toISOString();n+=";UNTIL="+o.substring(0,o.length-13).replace(/[-]/g,"")+"000000Z"}i.interval&&(n+=";INTERVAL="+i.interval),i.count&&(n+=";COUNT="+i.count)}d=d.replace("\n","\\n").replace(";",";").replace(",",",");var p=["BEGIN:VEVENT","CLASS:PUBLIC","DESCRIPTION:"+d,"DTSTART:"+l,"DTEND:"+m,"LOCATION:"+e,"SUMMARY;LANGUAGE=en-us:"+c,"END:VEVENT"];return n&&p.splice(4,0,n),p=p.join(a),b.push(p),p},download:function(e,f){if(b.length<1)return!1;f="undefined"!=typeof f?f:".ics",e="undefined"!=typeof e?e:"calendar";var g=c+a+b.join(a)+d,h=new Blob([g],{type:"text/x-vCalendar;charset="+document.characterSet});return saveAs(h,e+f),g}}};